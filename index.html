<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Descendants of John Thompson - Family Tree</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Crimson Text', Georgia, 'Times New Roman', serif;
      background:
        repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(139, 90, 43, 0.03) 2px,
          rgba(139, 90, 43, 0.03) 4px
        ),
        linear-gradient(135deg, #f4e4bc 0%, #e8d4a8 25%, #f0e0c0 50%, #dcc8a0 75%, #f2deb8 100%);
      min-height: 100vh;
      padding: 20px;
      position: relative;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(139, 90, 43, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(101, 67, 33, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 40% 60%, rgba(139, 90, 43, 0.05) 0%, transparent 40%);
      pointer-events: none;
    }
    .container { max-width: 100%; margin: 0 auto; position: relative; z-index: 1; }
    h1 {
      text-align: center;
      color: #4a3520;
      margin-bottom: 10px;
      font-family: 'Cinzel', Georgia, serif;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
      letter-spacing: 2px;
    }
    .subtitle {
      text-align: center;
      color: #6b5240;
      margin-bottom: 20px;
      font-style: italic;
    }
    .controls {
      background: linear-gradient(180deg, #faf3e3 0%, #f0e4cc 100%);
      padding: 15px;
      border-radius: 4px;
      border: 2px solid #8b6914;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.5),
        0 4px 12px rgba(101, 67, 33, 0.3);
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }
    .search-box {
      flex: 1;
      min-width: 200px;
      padding: 10px 15px;
      border: 2px solid #a08050;
      border-radius: 4px;
      font-size: 14px;
      outline: none;
      background: #fefcf5;
      font-family: 'Crimson Text', Georgia, serif;
      color: #4a3520;
    }
    .search-box:focus { border-color: #6b4423; background: #fffef8; }
    .search-box::placeholder { color: #a08060; font-style: italic; }
    .btn {
      padding: 8px 16px;
      border: 2px solid;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
      font-family: 'Cinzel', Georgia, serif;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .btn-gray {
      background: linear-gradient(180deg, #e8dcc8 0%, #d4c4a8 100%);
      color: #5a4a30;
      border-color: #a08050;
    }
    .btn-gray:hover { background: linear-gradient(180deg, #f0e4d0 0%, #e0d0b0 100%); }
    .btn-blue {
      background: linear-gradient(180deg, #d4c4a0 0%, #c4b088 100%);
      color: #4a3a20;
      border-color: #8b7040;
    }
    .btn-blue:hover { background: linear-gradient(180deg, #e0d0a8 0%, #d0c098 100%); }
    .btn-green {
      background: linear-gradient(180deg, #c8b898 0%, #b8a480 100%);
      color: #3a2a10;
      border-color: #7a6030;
    }
    .btn-green:hover { background: linear-gradient(180deg, #d4c4a0 0%, #c4b090 100%); }
    .legend {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
      width: 100%;
    }
    .legend span {
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 3px;
      font-family: 'Cinzel', Georgia, serif;
      font-weight: 600;
    }
    .main-content {
      display: flex;
      gap: 20px;
    }
    .tree-container {
      flex: 1;
      background:
        linear-gradient(180deg, rgba(255,252,245,0.95) 0%, rgba(250,243,227,0.95) 100%);
      border-radius: 4px;
      border: 3px double #8b6914;
      box-shadow:
        inset 0 0 30px rgba(139, 90, 43, 0.1),
        0 6px 20px rgba(101, 67, 33, 0.25);
      padding: 25px;
      height: calc(100vh - 200px);
      overflow: auto;
    }
    .details-panel {
      width: 380px;
      background:
        linear-gradient(180deg, rgba(255,252,245,0.95) 0%, rgba(250,243,227,0.95) 100%);
      border-radius: 4px;
      border: 3px double #8b6914;
      box-shadow:
        inset 0 0 30px rgba(139, 90, 43, 0.1),
        0 6px 20px rgba(101, 67, 33, 0.25);
      padding: 25px;
      display: none;
      height: calc(100vh - 200px);
      overflow-y: auto;
    }
    .details-panel.active { display: block; }
    .details-panel h3 {
      margin-bottom: 15px;
      color: #4a3520;
      font-family: 'Cinzel', Georgia, serif;
      border-bottom: 2px solid #c4a060;
      padding-bottom: 10px;
    }
    .detail-row {
      display: flex;
      margin-bottom: 8px;
      font-size: 14px;
    }
    .detail-label { font-weight: 600; color: #6b5240; width: 90px; flex-shrink: 0; }
    .detail-value { color: #4a3520; word-break: break-word; }
    .close-btn {
      float: right;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #8b6914;
    }
    .close-btn:hover { color: #4a3520; }
    .node {
      padding: 4px 0;
    }
    .node-content {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 3px;
      border: 2px solid;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
      font-family: 'Crimson Text', Georgia, serif;
    }
    .node-content:hover {
      box-shadow: 0 3px 10px rgba(101, 67, 33, 0.3);
      transform: translateY(-1px);
    }
    .toggle-btn {
      background: none;
      border: none;
      cursor: pointer;
      width: 20px;
      font-size: 12px;
      color: #8b6914;
    }
    .children {
      margin-left: 25px;
      border-left: 2px solid #c4a060;
      padding-left: 10px;
      display: none;
    }
    .children.expanded { display: block; }
    .child-count {
      font-size: 11px;
      color: #8b7050;
      margin-left: 5px;
    }
    .year { font-size: 12px; color: #8b7050; font-style: italic; }
    .highlight { background: #f5e6b8 !important; box-shadow: 0 0 0 3px #c4a030; }

    /* Generation colors - earthy antique palette */
    .gen-1 { background: linear-gradient(135deg, #f5e6c8 0%, #e8d4a0 100%); border-color: #b8860b; color: #5a4010; }
    .gen-2 { background: linear-gradient(135deg, #e8dcc8 0%, #d4c4a0 100%); border-color: #a0784c; color: #4a3020; }
    .gen-3 { background: linear-gradient(135deg, #dcd0b8 0%, #c8b898 100%); border-color: #8b7355; color: #3a2818; }
    .gen-4 { background: linear-gradient(135deg, #d0c4a8 0%, #bcac88 100%); border-color: #7a6040; color: #302010; }
    .gen-5 { background: linear-gradient(135deg, #c8bc98 0%, #b4a478 100%); border-color: #6b5030; color: #281808; }
    .gen-6 { background: linear-gradient(135deg, #c0b490 0%, #ac9c70 100%); border-color: #5c4428; color: #201000; }
    .gen-7 { background: linear-gradient(135deg, #b8ac88 0%, #a49468 100%); border-color: #4d3820; color: #180800; }
    .gen-8 { background: linear-gradient(135deg, #b0a480 0%, #9c8c60 100%); border-color: #403018; color: #100000; }
    .gen-9 { background: linear-gradient(135deg, #a89c78 0%, #948458 100%); border-color: #352810; color: #0a0000; }
    .gen-10 { background: linear-gradient(135deg, #a09470 0%, #8c7c50 100%); border-color: #2a2008; color: #050000; }

    .footer {
      text-align: center;
      margin-top: 20px;
      color: #6b5240;
      font-size: 13px;
      font-style: italic;
    }

    /* Scrollbar styling for antique look */
    .tree-container::-webkit-scrollbar,
    .details-panel::-webkit-scrollbar {
      width: 12px;
    }
    .tree-container::-webkit-scrollbar-track,
    .details-panel::-webkit-scrollbar-track {
      background: #e8dcc8;
      border-radius: 4px;
    }
    .tree-container::-webkit-scrollbar-thumb,
    .details-panel::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, #c4a060 0%, #a08040 100%);
      border-radius: 4px;
      border: 2px solid #e8dcc8;
    }
    .tree-container::-webkit-scrollbar-thumb:hover,
    .details-panel::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(180deg, #b89050 0%, #907030 100%);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŒ³ Descendants of John Thompson</h1>
    <p class="subtitle">Interactive family tree with <strong id="total-count">0</strong> people across 10 generations</p>
    
    <div class="controls">
      <input type="text" class="search-box" id="search" placeholder="Search by name...">
      <button class="btn btn-gray" onclick="collapseAll()">Collapse All</button>
      <button class="btn btn-blue" onclick="expandToGen(3)">Gen 1-3</button>
      <button class="btn btn-blue" onclick="expandToGen(4)">Gen 1-4</button>
      <button class="btn btn-green" onclick="expandAll()">Expand All</button>
      
      <div class="legend">
        <span style="color:#718096">Generations:</span>
        <span class="gen-1">1</span>
        <span class="gen-2">2</span>
        <span class="gen-3">3</span>
        <span class="gen-4">4</span>
        <span class="gen-5">5</span>
        <span class="gen-6">6</span>
        <span class="gen-7">7</span>
        <span class="gen-8">8</span>
        <span class="gen-9">9</span>
        <span class="gen-10">10</span>
      </div>
    </div>
    
    <div class="main-content">
      <div class="tree-container" id="tree"></div>
      <div class="details-panel" id="details">
        <button class="close-btn" onclick="closeDetails()">&times;</button>
        <h3 id="detail-name"></h3>
        <div id="detail-content"></div>
      </div>
    </div>
    
    <p class="footer">Click on any person to view details â€¢ Click â–¶ to expand branches</p>
  </div>

  <script>
    // Tree data (first 4 generations with details)
    const treeData = {"i":"1.1","n":"John Thompson","g":1,"m":["Susan Marsh"],"c":[{"i":"2.1","n":"George Thompson","g":2},{"i":"2.2","n":"James Thompson","g":2},{"i":"2.3","n":"Arthur Thompson","g":2},{"i":"2.4","n":"William Thompson","g":2},{"i":"2.5","n":"Sophia Thompson","g":2},{"i":"2.6","n":"John Thompson","g":2,"b":"1784","bp":"Freston, Suffolk, England","dp":"Magdalena, Buenos Aires","o":"Farmer, Shepherd","m":["Segovia","Martha Brocksopp","Phoebe Rowe"],"c":[{"i":"3.1","n":"George Thompson","g":3,"b":"1809","bp":"Southwark, London","dp":"Argentina","dd":"11 April 1863"},{"i":"3.2","n":"John JuliÃ¡n Thompson","g":3,"b":"1822","bp":"Buenos Aires","dp":"Argentina","dd":"2 August 1897","o":"Farmer"},{"i":"3.3","n":"Dominga Susannah Thompson","g":3,"b":"1824","bp":"CaÃ±uelas, Buenos Aires","dp":"Los Retamos, TristÃ¡n SuÃ¡rez","dd":"6 June 1903","o":"Teacher, Farmer","m":["George Rowe"],"c":[{"i":"4.1","n":"Henry Rowe","g":4,"b":"1841","bp":"CaÃ±uelas"},{"i":"4.2","n":"Harriet Rowe","g":4,"b":"1842","bp":"CaÃ±uelas"},{"i":"4.3","n":"George Rowe","g":4,"b":"1844","bp":"El Cardal","o":"Farmer"},{"i":"4.4","n":"John Thompson Rowe","g":4,"b":"1846","bp":"El Cardal","dd":"4 December 1929","o":"Teacher"}]},{"i":"3.4","n":"Ignacio Henry Thompson","g":3,"b":"1826","bp":"CaÃ±uelas, Buenos Aires","dp":"San Vicente","dd":"18 September 1897","o":"Farmer","m":["Isidora Maciel","Feliza Palacios","Margaret Cowan"],"c":[{"i":"4.5","n":"Isidora Thompson","g":4,"b":"1847","bp":"Magdalena"},{"i":"4.6","n":"EncarnaciÃ³n Yrenea Palacios","g":4,"b":"1849"},{"i":"4.7","n":"Toribio Palacios Thompson","g":4,"b":"1851","bp":"Magdalena","o":"Farmer"},{"i":"4.8","n":"William Henry Thompson","g":4,"b":"1858","bp":"Magdalena"},{"i":"4.9","n":"Susan Harriet Thompson","g":4,"b":"1859","bp":"Magdalena","dd":"20 January 1882"},{"i":"4.10","n":"Enrique Alejandro Thompson","g":4,"b":"1862","bp":"Magdalena","o":"Farmer"},{"i":"4.11","n":"Juan Thompson","g":4,"b":"1863","bp":"Magdalena","dd":"23 May 1951","o":"Farmer","m":["Sara Ethel Denyer"],"c":[{"i":"5.24","n":"Sara Isabel Thompson","g":5,"bp":"Magdalena","o":"Farmer"},{"i":"5.25","n":"Susana Margarita Thompson","g":5,"b":"1894","bp":"Magdalena"},{"i":"5.26","n":"Ernesto Juan Thompson","g":5,"b":"1896","bp":"Magdalena"},{"i":"5.27","n":"Enrique Juan Thompson","g":5,"b":"1898","bp":"Magdalena","o":"Farmer"},{"i":"5.28","n":"Dora Ada Thompson","g":5,"b":"1901","bp":"Magdalena"},{"i":"5.29","n":"LÃ­a Mercedes Thompson","g":5,"b":"1904","bp":"La Plata"},{"i":"5.30","n":"Alfredo Hugo Pique Thompson","g":5,"b":"1910","bp":"La Plata","o":"Farmer"}]},{"i":"4.12","n":"George William Thompson","g":4,"b":"1865","bp":"Cinco Alamos","m":["Edith Julia Cooper"],"c":[{"i":"5.31","n":"George Kenneth Thompson","g":5,"b":"1894","bp":"England"},{"i":"5.32","n":"Gwendolin Marie Thompson","g":5,"b":"1896","bp":"England"},{"i":"5.33","n":"John Eric Sidney Thompson","g":5,"b":"1898","bp":"London"}]},{"i":"4.13","n":"Alfred Lot Thompson","g":4,"b":"1867","bp":"Cinco Alamos","dd":"26 June 1956","o":"Farmer"},{"i":"4.14","n":"Martha Brocksopp Thompson","g":4,"b":"1869","bp":"Cinco Alamos"},{"i":"4.15","n":"Rodolfo Brocksopp Thompson","g":4,"b":"1871","bp":"Cinco Alamos, Magdalena","dd":"16 June 1936","o":"Farmer","m":["Dominga Ezequiela Linhart"],"c":[{"i":"5.35","n":"Adolfo NicolÃ¡s Thompson","g":5,"b":"1911","bp":"Buenos Aires","dd":"16 October 1970","o":"Farmer","m":["Dora Magdalena Bagnasco"],"c":[{"i":"6.61","n":"Susana Alicia Thompson","g":6,"b":"1949","bp":"Buenos Aires"},{"i":"6.62","n":"Rodolfo RubÃ©n Thompson","g":6,"b":"1952","bp":"Buenos Aires"},{"i":"6.63","n":"AnalÃ­a Mabel Thompson","g":6,"b":"1954","bp":"Buenos Aires"},{"i":"6.64","n":"Jorge Carlos Thompson","g":6,"b":"1958","bp":"Buenos Aires"}]},{"i":"5.36","n":"Guillermo Eduardo Thompson","g":5,"b":"1912","bp":"Buenos Aires","dd":"27 October 1912"},{"i":"5.37","n":"HaydÃ©e Pura Thompson","g":5,"b":"1917","bp":"Buenos Aires","dd":"8 April 1999","o":"Farmer","m":["JosÃ© Bagnasco"],"c":[{"i":"6.65","n":"Elsa Margarita Bagnasco","g":6,"b":"1940","bp":"Buenos Aires"},{"i":"6.66","n":"Roberto Juan Bagnasco","g":6,"b":"1941","bp":"Buenos Aires"},{"i":"6.67","n":"Elda Zulema Bagnasco","g":6,"b":"1942","bp":"Buenos Aires"},{"i":"6.68","n":"Yolanda Beatriz Bagnasco","g":6,"b":"1944","bp":"Buenos Aires"},{"i":"6.69","n":"HaydÃ©e Alicia Bagnasco","g":6,"b":"1948","bp":"Buenos Aires"},{"i":"6.70","n":"InÃ©s Delia Bagnasco","g":6,"b":"1949","bp":"Buenos Aires"},{"i":"6.71","n":"Silvia Irene Bagnasco","g":6,"b":"1953","bp":"Buenos Aires"}]},{"i":"5.38","n":"Lydia Ada Thompson","g":5,"b":"1919","bp":"Buenos Aires","o":"Farmer","m":["Marco Antonio Sierra"],"c":[{"i":"6.72","n":"Lidia Ada Sierra","g":6,"b":"1944","bp":"Buenos Aires"},{"i":"6.73","n":"Marco Antonio Jesus Sierra","g":6,"b":"1945","bp":"Buenos Aires"},{"i":"6.74","n":"Elvira Virginia Sierra","g":6,"b":"1947","bp":"Buenos Aires"},{"i":"6.75","n":"Rodolfo Juan RamÃ³n Sierra","g":6,"b":"1948","bp":"Buenos Aires"},{"i":"6.76","n":"Cecilia AÃ­da Sierra","g":6,"b":"1951","bp":"Buenos Aires"},{"i":"6.77","n":"Adriana Evelina Sierra","g":6,"b":"1952","bp":"Buenos Aires"},{"i":"6.78","n":"Hemilse Silvana Sierra","g":6,"b":"1954","bp":"Arenaza, Buenos Aires","o":"Artist","m":["Gerardo Manuel RodrÃ­guez Ardiles"],"c":[{"i":"7.132","n":"MarÃ­a Virginia RodrÃ­guez Ardiles","g":7,"b":"1985","bp":"Buenos Aires"},{"i":"7.133","n":"Mariano GermÃ¡n RodrÃ­guez Ardiles","g":7,"b":"1988","bp":"Buenos Aires"}]},{"i":"6.79","n":"Gustavo Adolfo Sierra","g":6,"b":"1955","bp":"Arenaza, Buenos Aires","m":["Beatriz Chimondeguy"],"c":[{"i":"7.134","n":"Diego MartÃ­n Sierra","g":7,"b":"1984","bp":"Buenos Aires"},{"i":"7.135","n":"Matias AgustÃ­n Sierra","g":7,"b":"1986","bp":"Buenos Aires"}]}]},{"i":"5.39","n":"Celsa Margarita Thompson","g":5,"b":"1919","bp":"Buenos Aires","o":"Farmer","m":["Carlos Guillermo Sierra"],"c":[{"i":"6.80","n":"Carlos Guillermo Gerardo Sierra","g":6,"b":"1948","bp":"Buenos Aires"},{"i":"6.81","n":"Celsa Margarita Sierra","g":6,"b":"1951","bp":"Buenos Aires"}]}]},{"i":"4.16","n":"Janet Ada Thompson","g":4,"b":"1875","bp":"Buenos Aires","dd":"30 April 1975","m":["John Alfred Earnshaw"],"c":[{"i":"5.40","n":"Lydia Beatrice Earnshaw","g":5,"b":"1899","bp":"Buenos Aires"},{"i":"5.41","n":"Enrique Mauricio Earnshaw","g":5,"b":"1902","bp":"Buenos Aires"},{"i":"5.42","n":"Juan Alfredo Earnshaw","g":5,"b":"1905","bp":"Buenos Aires"}]}]},{"i":"3.5","n":"Norberta Martha Thompson","g":3,"b":"1829","bp":"Buenos Aires","dd":"1901","m":["William Dickson"],"c":[{"i":"4.17","n":"Hannah Dickson","g":4,"b":"1860","bp":"Buenos Aires","dd":"4 September 1957"},{"i":"4.18","n":"Mathilda Dickson","g":4,"b":"1862","bp":"Buenos Aires","dd":"12 April 1954"},{"i":"4.19","n":"Martha Ellen Dickson","g":4,"b":"1864","bp":"Buenos Aires","dd":"18 November 1864"},{"i":"4.20","n":"Margaret Dickson","g":4,"b":"1866","bp":"Ensenada"},{"i":"4.21","n":"William Dickson","g":4,"b":"1867","bp":"Ensenada","dd":"30 November 1955","o":"Farmer","m":["Norberta Thompson"],"c":[{"i":"5.47","n":"Guillermo Carlos Dickson","g":5,"bp":"GuaminÃ­"},{"i":"5.48","n":"InÃ©s Dickson","g":5,"b":"1895","bp":"GuaminÃ­"},{"i":"5.49","n":"Sara Adelaida Dickson","g":5,"b":"1896","bp":"Mercedes"},{"i":"5.50","n":"Ricardo Reynaldo Dickson","g":5,"b":"1899","bp":"TristÃ¡n SuÃ¡rez"},{"i":"5.51","n":"Alberto Dickson","g":5,"b":"1901","bp":"TristÃ¡n SuÃ¡rez"},{"i":"5.52","n":"Enrique Pedro Dickson","g":5,"b":"1903","bp":"TristÃ¡n SuÃ¡rez"},{"i":"5.53","n":"Roberto Dickson","g":5,"b":"1904","bp":"TristÃ¡n SuÃ¡rez"},{"i":"5.54","n":"Jorge Dickson","g":5,"b":"1904","bp":"TristÃ¡n SuÃ¡rez"}]},{"i":"4.22","n":"Martha Dickson","g":4,"b":"1870","bp":"Ensenada","dd":"14 July 1963"},{"i":"4.23","n":"Agnes Dickson","g":4,"b":"1872","bp":"Buenos Aires","dd":"10 November 1885"}]},{"i":"3.6","n":"Galo Lott Thompson","g":3,"b":"1831","bp":"CaÃ±uelas, Buenos Aires","dd":"26 March 1891","o":"Farmer","m":["Margaret McKiddie"],"c":[{"i":"4.24","n":"Lot Thompson","g":4,"b":"1857","bp":"Saladillo","dd":"5 June 1869"},{"i":"4.25","n":"Albert James Thompson","g":4,"b":"1859","bp":"Saladillo"},{"i":"4.26","n":"Hannah Burns Thompson","g":4,"b":"1861","bp":"Saladillo","dd":"9 September 1924"},{"i":"4.27","n":"Margaret Ellen Thompson","g":4,"b":"1863","bp":"Saladillo"},{"i":"4.28","n":"Carolina Flora Thompson","g":4,"b":"1866","bp":"Saladillo"},{"i":"4.29","n":"Alejandro Rafael Thompson","g":4,"b":"1868","bp":"Saladillo","dd":"27 January 1937"},{"i":"4.30","n":"Alfredo Thompson","g":4,"b":"1872"},{"i":"4.31","n":"Emiliana Thompson","g":4,"b":"1875","bp":"Buenos Aires"},{"i":"4.32","n":"Herminda Elvira Brocksopp Thompson","g":4,"b":"1881","bp":"Saladillo"}]},{"i":"3.7","n":"Phoebe Thompson","g":3,"b":"1837","bp":"Buenos Aires","m":["JosÃ© MarÃ­a Faletty Avalos"],"c":[{"i":"4.33","n":"Edmundo Faletty Thompson","g":4,"b":"1859"},{"i":"4.34","n":"Elena MarÃ­a Faletty Thompson","g":4,"b":"1861"},{"i":"4.35","n":"Arturo JosÃ© Faletty Thompson","g":4,"b":"1864","bp":"Buenos Aires"},{"i":"4.36","n":"Augusta Faletty Thompson","g":4,"b":"1869","bp":"Buenos Aires"},{"i":"4.37","n":"Phoebe Faletty Thompson","g":4,"b":"1870","bp":"Buenos Aires","dd":"1955"},{"i":"4.38","n":"Gerardo Cecilio Faletty Thompson","g":4,"b":"1871","bp":"Buenos Aires"},{"i":"4.39","n":"MarÃ­a Dolores Faletty Thompson","g":4,"b":"1873","bp":"Buenos Aires"},{"i":"4.40","n":"JosÃ© Leopoldo Faletty Thompson","g":4,"b":"1877","bp":"Buenos Aires"},{"i":"4.41","n":"Carlos Segundo Faletty Thompson","g":4,"b":"1879","dd":"1974"}]},{"i":"3.8","n":"Edward Thompson","g":3,"b":"1840","bp":"Buenos Aires","dd":"1840"},{"i":"3.9","n":"Helen Thompson","g":3,"b":"1841","bp":"Buenos Aires","dd":"before 1869","m":["Edmundo Cecilio Kirk"],"c":[{"i":"4.42","n":"Edmund T. Kirk","g":4,"b":"1862","bp":"Buenos Aires","o":"Farmer"}]},{"i":"3.10","n":"William Thompson","g":3,"b":"1841","bp":"Buenos Aires","dd":"1851"},{"i":"3.11","n":"Anastasia Francisca Augusta del Sagrado CorazÃ³n de JesÃºs Thompson","g":3,"b":"1843","bp":"Buenos Aires","dp":"Lima, Peru","dd":"18 February 1906","m":["Ralph John Barton Wild"],"c":[{"i":"4.43","n":"Norma Agnes Barton Thompson","g":4,"b":"1865","bp":"Buenos Aires"},{"i":"4.44","n":"Amalia Eve Barton Thompson","g":4,"b":"1866","bp":"Buenos Aires","dd":"26 January 1963"},{"i":"4.45","n":"Ralph Alexander Barton Thompson","g":4,"b":"1869","bp":"Buenos Aires","dd":"25 November 1946"},{"i":"4.46","n":"Albert Edward Barton Thompson","g":4,"b":"1870","bp":"Buenos Aires","dd":"25 October 1950"},{"i":"4.47","n":"Arminda MarÃ­a del Rosario Barton Thompson","g":4,"b":"1872","bp":"Buenos Aires"},{"i":"4.48","n":"Hortensia Florencia Phebe Barton Thompson","g":4,"b":"1877","bp":"Lima"},{"i":"4.49","n":"MarÃ­a Augusta Leticia Barton Thompson","g":4,"b":"1881","bp":"Lima","dd":"2 October 1953"},{"i":"4.50","n":"Leopoldo Ernesto Juan de Mata Barton Thompson","g":4,"b":"1884","bp":"Lima","dd":"14 February 1956"},{"i":"4.51","n":"AÃ­da LucÃ­a Mercedes Barton Thompson","g":4,"b":"1887","bp":"Lima","dd":"13 May 1958","o":"Teacher"}]},{"i":"3.12","n":"Stillborn Thompson","g":3,"b":"1845","dd":"20 March 1845"},{"i":"3.13","n":"Stillborn Thompson","g":3,"b":"1847","bp":"Buenos Aires"}]}]};

    let expandedNodes = new Set(['1.1', '2.6']);
    let selectedPerson = null;

    function countNodes(node) {
      let count = 1;
      if (node.c) {
        node.c.forEach(child => count += countNodes(child));
      }
      return count;
    }

    function renderTree() {
      const container = document.getElementById('tree');
      container.innerHTML = renderNode(treeData);
      document.getElementById('total-count').textContent = countNodes(treeData);
    }

    function renderNode(node, level = 0) {
      const hasChildren = node.c && node.c.length > 0;
      const isExpanded = expandedNodes.has(node.i);
      const searchTerm = document.getElementById('search').value.toLowerCase();
      const isHighlighted = searchTerm && node.n.toLowerCase().includes(searchTerm);
      
      let html = `<div class="node" style="margin-left: ${level * 10}px">`;
      
      if (hasChildren) {
        html += `<button class="toggle-btn" onclick="toggleNode('${node.i}')">${isExpanded ? 'â–¼' : 'â–¶'}</button>`;
      } else {
        html += `<span style="display:inline-block;width:20px"></span>`;
      }
      
      html += `<span class="node-content gen-${node.g} ${isHighlighted ? 'highlight' : ''}" onclick="showDetails('${node.i}')">`;
      html += `<span>${node.n}</span>`;
      if (node.b) html += `<span class="year">(${node.b})</span>`;
      if (hasChildren) html += `<span class="child-count">ðŸ‘¥ ${node.c.length}</span>`;
      html += `</span>`;
      
      if (hasChildren) {
        html += `<div class="children ${isExpanded ? 'expanded' : ''}" id="children-${node.i}">`;
        node.c.forEach(child => {
          html += renderNode(child, level + 1);
        });
        html += `</div>`;
      }
      
      html += `</div>`;
      return html;
    }

    function findNode(node, id) {
      if (node.i === id) return node;
      if (node.c) {
        for (let child of node.c) {
          const found = findNode(child, id);
          if (found) return found;
        }
      }
      return null;
    }

    function toggleNode(id) {
      if (expandedNodes.has(id)) {
        expandedNodes.delete(id);
      } else {
        expandedNodes.add(id);
      }
      renderTree();
    }

    function showDetails(id) {
      const person = findNode(treeData, id);
      if (!person) return;
      
      selectedPerson = person;
      document.getElementById('detail-name').textContent = person.n;
      
      let content = '';
      
      // Basic Info Section
      content += '<div style="margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #c4a060">';
      content += '<div style="font-weight:600;color:#4a3520;margin-bottom:8px;font-family:Cinzel,Georgia,serif">Basic Info</div>';
      content += `<div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value">${person.i}</span></div>`;
      content += `<div class="detail-row"><span class="detail-label">Generation:</span><span class="detail-value">${person.g}</span></div>`;
      if (person.o) content += `<div class="detail-row"><span class="detail-label">Occupation:</span><span class="detail-value">${person.o}</span></div>`;
      content += '</div>';
      
      // Birth Info Section
      if (person.b || person.bp) {
        content += '<div style="margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #c4a060">';
        content += '<div style="font-weight:600;color:#4a3520;margin-bottom:8px;font-family:Cinzel,Georgia,serif">Birth</div>';
        if (person.b) content += `<div class="detail-row"><span class="detail-label">Year:</span><span class="detail-value">${person.b}</span></div>`;
        if (person.bp) content += `<div class="detail-row"><span class="detail-label">Place:</span><span class="detail-value">${person.bp}</span></div>`;
        content += '</div>';
      }
      
      // Death Info Section
      if (person.dd || person.dp) {
        content += '<div style="margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #c4a060">';
        content += '<div style="font-weight:600;color:#4a3520;margin-bottom:8px;font-family:Cinzel,Georgia,serif">Death</div>';
        if (person.dd) content += `<div class="detail-row"><span class="detail-label">Date:</span><span class="detail-value">${person.dd}</span></div>`;
        if (person.dp) content += `<div class="detail-row"><span class="detail-label">Place:</span><span class="detail-value">${person.dp}</span></div>`;
        content += '</div>';
      }
      
      // Marriage Info Section
      if (person.m && person.m.length) {
        content += '<div style="margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #c4a060">';
        content += '<div style="font-weight:600;color:#4a3520;margin-bottom:8px;font-family:Cinzel,Georgia,serif">Marriage(s)</div>';
        person.m.forEach((spouse, idx) => {
          content += `<div class="detail-row"><span class="detail-label">Spouse ${person.m.length > 1 ? (idx+1) : ''}:</span><span class="detail-value">${spouse}</span></div>`;
        });
        content += '</div>';
      }
      
      // Children Info Section
      if (person.c && person.c.length) {
        content += '<div style="margin-bottom:10px">';
        content += '<div style="font-weight:600;color:#4a3520;margin-bottom:8px;font-family:Cinzel,Georgia,serif">Children (' + person.c.length + ')</div>';
        content += '<div style="max-height:150px;overflow-y:auto;font-size:13px">';
        person.c.forEach((child, idx) => {
          content += `<div style="padding:4px 0;border-bottom:1px solid #d4c4a0">${idx+1}. ${child.n}${child.b ? ' ('+child.b+')' : ''}</div>`;
        });
        content += '</div></div>';
      }
      
      document.getElementById('detail-content').innerHTML = content;
      document.getElementById('details').classList.add('active');
    }

    function closeDetails() {
      document.getElementById('details').classList.remove('active');
    }

    function collapseAll() {
      expandedNodes = new Set(['1.1']);
      renderTree();
    }

    function expandAll() {
      const collectIds = (node) => {
        expandedNodes.add(node.i);
        if (node.c) node.c.forEach(collectIds);
      };
      collectIds(treeData);
      renderTree();
    }

    function expandToGen(gen) {
      expandedNodes = new Set();
      const collect = (node) => {
        if (node.g <= gen) {
          expandedNodes.add(node.i);
          if (node.c) node.c.forEach(collect);
        }
      };
      collect(treeData);
      renderTree();
    }

    document.getElementById('search').addEventListener('input', renderTree);

    // Initial render
    renderTree();
  </script>
</body>
</html>
